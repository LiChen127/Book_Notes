# Rxjs

## 信息管道

### 不同的 "单一职责"

如果你阅读过关于现代浏览器基本原理的资料，就会知道为了能够稳定、安全、流畅地呈现出网页的内容，浏览器需要使用的进程至少包括主进程、渲染进程、网络进程、GPU进程、插件进程等，每个进程负责一项独立的任务。我们看到的每个页面通常会由一个渲染进程来管理，典型的渲染进程中又包括GUI渲染线程、JavaScript引擎线程、事件队列线程、定时器线程、网络请求线程等多个线程，它们之间也是并行协作的关系（如图8-1所示）​。把专项的任务交给特定的模块去完成，正是“单一职责”原则的体现。

前端的工具库是基于“面向切面”的思路来实现的，它们大多针对的是整个任务生命周期中的某个步骤，网络请求的库只负责处理网络请求的任务，状态管理的库则只负责状态管理的任务，这个任务通常是发生在某个时间段内的，不会覆盖程序的整个生命周期；浏览器架构在职责的划分上，更倾向于将复杂的任务拆分为并行的子任务，让进程或线程在整个生命周期内都只负责一个类型的任务。如果在前端编写业务逻辑时也参考浏览器底层架构的任务分解思路，应用层的代码会变成什么样子呢？此时的“单一职责”就不再是“单一功能职责”​，而是一种“单一业务职责”了，每个拆分后的子业务都包含网络请求、状态管理、数据转换、页面渲染等关键任务，你需要将它们聚合在一起形成“业务自治”的模块，有时也称为“区块”​，这时处理好所有与特定子业务相关的任务就成了区块的“单一职责”​，现在流行的“微前端”架构设计宏观上也是这样一种模式。

JavaScript程序是基于事件驱动机制来工作的，事件既可以是浏览器直接发出的信息，也可以是自定义的信息，还可以是网络请求得到了服务端的响应，为了便于理解，我们统一将触发机制称为事件. 

### 分布式状态的可能性